<script>
    
    function mostrarTablaContactos() {
        if(document.getElementById('tablaContactos')) {
            alert('La tabla ya se esta mostrando!');
            return;
        }

        google.script.run.withSuccessHandler(obj => {
            let tabla = document.createElement('table');
            tabla.id = 'tablaContactos';

            let tablaHeader = document.createElement('thead');
            let tablaBody = document.createElement('tbody');

            Array.from(obj).forEach((filaActual, i) => {
                let fila = document.createElement('tr');

                filaActual.forEach(celdaActual => {
                    let celda = document.createElement('td');
                    celda.textContent = celdaActual;
                    fila.appendChild(celda);
                })
                
                if(i == 0) {
                    tablaHeader.appendChild(fila);
                    tabla.appendChild(tablaHeader);
                } else {
                    tablaBody.appendChild(fila);
                }
                //i == 0? tabla.appendChild(tablaHeader.appendChild(fila)): tablaBody.appendChild(fila); => porque no funciona??
            })

            tabla.appendChild(tablaBody);

            tablaHeader.classList.add('table-dark');
            tabla.classList.add('table', 'table-striped', 'border', 'border-3');

            document.getElementById("contactosContainer").appendChild(tabla);
        }).obtenerContactos();
    }

</script>